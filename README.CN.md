# StartPage 插件

[English](README.md) | 中文

一个为 Obsidian 设计的现代化启动首页插件，提供美观的仪表板界面，展示笔记库统计信息、置顶笔记和最近修改的笔记。当启动 Obsidian 或打开新标签页时，自动显示个性化的首页，让您快速访问重要内容。

## 功能特性

### 智能首页
- **自动启动首页**: 启用后自动将新标签页替换为启动首页
- **现代化设计**: 采用卡片式布局，支持响应式设计，完美适配各种屏幕尺寸
- **仪表板统计**: 实时显示笔记库统计信息（总笔记数、今日编辑数、总占用空间）
- **快速搜索**: 内置搜索框，支持键盘快捷操作 - 直接输入字符即可搜索笔记
- **工具栏集成**: 在左侧工具栏添加首页图标，随时快速访问
- **命令面板**: 通过命令访问启动首页（"打开启动首页" 和 "在新标签页打开启动首页"）

### 笔记管理
- **置顶笔记**: 可以设置重要的笔记在首页置顶显示，支持快速访问
- **最近笔记**: 显示最近访问和修改的笔记，智能综合修改时间和访问时间排序
- **智能搜索模态框**: 功能完整的搜索，支持模糊匹配和区分大小写选项
- **动态数量**: 可在首页直接调整最近笔记显示数量（5-50个）
- **右键菜单**: 支持在文件浏览器和置顶笔记上通过右键菜单添加/移除置顶笔记
- **从书签导入**: 轻松从 Obsidian 内置书签功能导入置顶笔记
- **重新排序置顶笔记**: 在设置中上下移动置顶笔记以自定义显示顺序

### 用户体验
- **智能时间显示**: 为最近笔记自动显示相对时间（几分钟前、几小时前、几天前）
- **多语言支持**: 自动使用 Obsidian 的语言设置（支持中文和英文）
- **实时刷新**: 文件修改、创建、删除或重命名时自动刷新首页内容
- **定时更新**: 24小时内的笔记会启动定时时间显示刷新（每分钟）
- **右键菜单**: 支持在启动首页上右键刷新功能
- **主题适配**: 完美适配 Obsidian 的明暗主题
- **滚动位置记忆**: 记住并恢复您返回启动首页时的滚动位置
- **键盘导航**: 在启动首页输入任意字符即可立即打开搜索模态框

## 安装

### 从 Obsidian 社区插件安装

1. 打开 Obsidian 设置。
2. 进入"社区插件"选项卡。
3. 关闭"安全模式"。
4. 点击"浏览"按钮。
5. 搜索"StartPage"。
6. 点击安装并启用插件。

### 手动安装

1. 从 GitHub 的 Releases 页面下载最新版本的插件文件。
2. 在你的 Obsidian 库中创建 `.obsidian/plugins/obsidian-startpage/` 文件夹。
3. 将下载的 `main.js`、`styles.css`、`manifest.json` 文件复制到该文件夹中。
4. 重启 Obsidian。
5. 在设置 → 社区插件中启用 "Startpage" 插件。

## 界面截图

### 桌面端界面

#### 浅色主题
<img src="Screenshots/startpage-desktop-light.png" alt="StartPage Desktop Light" width="600"/>

*桌面端浅色主题下的 StartPage 界面*

<img src="Screenshots/setting-desktop-light.png" alt="Settings Desktop Light" width="600"/>

*浅色主题下的插件设置界面*

#### 深色主题
<img src="Screenshots/startpage-desktop-dark.png" alt="StartPage Desktop Dark" width="600"/>

*桌面端深色主题下的 StartPage 界面*

<img src="Screenshots/setting-desktop-dark.png" alt="Settings Desktop Dark" width="600"/>

*深色主题下的插件设置界面*

### 移动端界面

#### 浅色主题
<img src="Screenshots/startpage-mobile-light.png" alt="StartPage Mobile Light" width="400"/>

*移动端浅色主题下的 StartPage 界面*

<img src="Screenshots/setting-mobile-light.png" alt="Settings Mobile Light" width="400"/>

*移动端浅色主题下的插件设置界面*

#### 深色主题
<img src="Screenshots/startpage-mobile-dark.png" alt="StartPage Mobile Dark" width="400"/>

*移动端深色主题下的 StartPage 界面*

<img src="Screenshots/setting-mobile-dark.png" alt="Settings Mobile Dark" width="400"/>

*移动端深色主题下的插件设置界面*

## 使用方法

### 基本使用

1. **启动首页**: 安装并启用插件后，可以通过以下方式打开启动首页：
   - 点击左侧工具栏的首页图标
   - 使用命令面板搜索 "打开启动首页" 或 "在新标签页打开启动首页"
   - 如果启用了"替换新标签页"功能，打开新标签页时会自动显示
2. **查看统计**: 首页顶部显示笔记库的统计信息（总笔记数、今日编辑数、总占用空间）
3. **快速搜索**: 在启动首页上直接输入任意字符即可打开搜索模态框，或点击搜索框/统计卡片
4. **访问笔记**: 点击置顶笔记或最近笔记可以直接打开对应的笔记
5. **右键操作**: 在文件浏览器中右键点击文件，可以快速添加或移除置顶笔记；在置顶笔记上右键可移除

### 设置置顶笔记

1. 打开 Obsidian 设置。
2. 找到"StartPage"设置选项卡。
3. 点击"选择笔记"按钮。
4. 在弹出的搜索框中输入笔记名称进行模糊搜索。
5. 选择要置顶的笔记，它会显示在首页的"置顶笔记"部分。
6. 或者，在文件浏览器中右键点击任意文件，选择"添加到置顶笔记"。
7. 您也可以点击设置中的"导入书签"，将所有书签笔记导入置顶笔记。
8. 点击首页置顶笔记区域的"管理"按钮可以快速跳转到设置页面。
9. 使用设置中的上下箭头按钮重新排序置顶笔记。

### 自定义设置

#### 常规设置
- **包含所有文件**: 选择在最近笔记中显示所有文件类型还是仅显示 Markdown 文件
- **最近笔记数量**: 在首页直接调整显示数量（5-50个），或在设置中修改

#### 外观设置
- **标题导航栏**: 选择显示、隐藏或使用默认行为（桌面端隐藏，移动端显示）
- **显示统计栏**: 开启或关闭仪表板统计部分

#### 新标签页设置
- **替换新标签页**: 打开新标签页时自动显示启动首页

#### 页脚设置
- **自定义页脚文本**: 启用并设置启动首页的自定义页脚文本
- **随机页脚文本**: 使用随机生成的引用/文本（每天自动获取）
- **刷新页脚**: 点击刷新图标获取新的随机引用

#### 置顶笔记管理
- **选择笔记**: 通过模糊搜索模态框添加笔记
- **从书签导入**: 将所有书签文件导入到置顶笔记
- **重新排序**: 上下移动笔记以自定义显示顺序
- **移除**: 从置顶列表中移除笔记

**注意**: 所有设置修改后会立即在首页生效。

## 开发

### 环境要求

- Node.js 16.0 或更高版本
- Obsidian 1.8.7 或更高版本

### 本地开发设置

1.  **克隆仓库**:
    ```bash
    git clone https://github.com/kuzzh/obsidian-startpage.git
    cd obsidian-startpage
    ```
2.  **安装依赖**:
    ```bash
    npm install
    ```
3.  **设置Obsidian插件目录**:
    -   将 `env-example.json` 文件重命名为 `env.json`。
    -   打开 `env.json` 文件，将其中的 `OBSIDIAN_PLUGIN_DIR` 的值修改为你的Obsidian插件目录的绝对路径。例如：
        ```json
        {
          "OBSIDIAN_PLUGIN_DIR": "D:\\Documents\\Obsidian\\.obsidian\\plugins\\obsidian-startpage"
        }
        ```
    -   这一步确保了构建产物能够自动同步到你的笔记库中，方便进行测试。
4.  **启动开发服务**:
    ```bash
    npm run dev
    ```
    此命令会监听文件变动，重新构建插件，并将其同步到 `env.json` 中指定的目录。
5.  **在Obsidian中启用插件**:
    -   打开Obsidian的设置。
    -   进入“社区插件”选项卡。
    -   确保“安全模式”已关闭。
    -   在已安装插件列表中找到“Startpage”并启用它。

### 构建

若要创建生产环境的构建，请运行以下命令：
```bash
npm run build
```

## 功能详解

### 仪表板统计

- **总笔记数**: 显示笔记库中所有 Markdown 文件的数量
- **今日编辑**: 统计今天修改过的笔记数量（从午夜开始）
- **总占用空间**: 显示所有文件的总大小（遵循"包含所有文件"设置；自动格式化为 B/KB/MB/GB）
- **实时更新**: 统计数据会随着文件变化自动更新
- **交互功能**: 点击任意统计卡片可打开搜索模态框
- **切换可见性**: 可通过"显示统计栏"设置隐藏

### 笔记展示

- **置顶笔记区域**:
  - 显示用户手动设置的重要笔记，支持自定义顺序
  - 支持无限添加置顶笔记
  - 一键管理按钮，快速跳转到设置页面
  - 右键点击任意置顶笔记可将其从置顶列表中移除
  - 显示文件图标、标题、文件夹路径和修改时间
  - 点击打开笔记到当前标签页，如已打开则显示该标签页
- **最近笔记区域**:
  - 显示最近访问和修改的笔记，智能排序
  - 综合修改时间和访问时间（最近打开的文件排名更高）
  - 支持在页面上直接动态调整显示数量（5-50个）
  - 智能时间显示（最近笔记显示相对时间如"5分钟前"）
  - 显示文件类型图标、标题、文件夹路径和修改时间
  - 遵循"包含所有文件"设置（所有文件类型 vs. 仅 Markdown）

### 智能刷新机制

- **文件监听**: 自动监听文件的修改、创建、删除、重命名事件
- **定时刷新**: 24小时内修改的笔记会启动定时时间显示更新（每分钟）
- **手动刷新**: 在启动首页任意位置右键点击并选择"刷新"
- **性能优化**: 智能判断是否需要刷新，避免不必要的性能消耗
- **滚动位置**: 自动保存并恢复离开和返回时的滚动位置

### 多语言支持

- **自动语言检测**: 自动使用 Obsidian 的界面语言设置
- **双语界面**: 完整支持中文和英文界面
- **本地化显示**: 时间格式、数字格式和所有 UI 文本完全本地化
- **扩展性**: 架构支持轻松添加更多语言

## 界面特色

### 现代化设计
- **卡片式布局**: 采用现代化的卡片设计，信息层次清晰。
- **渐变效果**: 精美的渐变色彩和阴影效果。
- **响应式设计**: 完美适配桌面端和移动端。
- **主题兼容**: 自动适配 Obsidian 的明暗主题。

### 交互体验
- **悬停效果**: 笔记项和按钮的丰富鼠标悬停动画效果
- **点击反馈**: 清晰的点击反馈和状态变化
- **键盘支持**: 输入任意字符即可打开搜索；搜索模态框中完整的键盘导航
- **智能搜索**: 点击搜索框或统计卡片打开功能完整的搜索模态框，支持模糊匹配
- **创建笔记**: 在空搜索结果中按 Enter 键，以搜索查询为标题创建新笔记
- **无障碍访问**: 遵循无障碍设计原则，具有适当的 ARIA 标签

## 技术特性

- **TypeScript 开发**: 使用 TypeScript 确保代码质量和类型安全
- **模块化架构**: 核心逻辑、视图和工具之间清晰分离
- **性能优化**: 高效的文件监听和防抖滚动位置保存
- **内存管理**: 自动清理定时器和事件监听器，避免内存泄漏
- **设置备份**: 自动每日备份设置以防止数据丢失
- **事件系统**: 使用 Obsidian 事件系统进行适当的事件注册和清理
- **移动端支持**: 在桌面端和移动端平台上完全功能

## 贡献

欢迎提交 Issue 和 Pull Request。

### 开发指南
1. Fork 本仓库。
2. 创建功能分支 (`git checkout -b feature/AmazingFeature`)。
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)。
4. 推送到分支 (`git push origin feature/AmazingFeature`)。
5. 打开 Pull Request。

## 许可证

本项目基于 MIT 许可证。详情请参阅 [LICENSE](LICENSE) 文件。

## 致谢

- 感谢 Obsidian 团队提供的优秀插件API和开发框架。
- 感谢所有贡献者和用户的反馈与支持。
